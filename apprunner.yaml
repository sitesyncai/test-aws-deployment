# apprunner.yaml for SOURCE CODE deployment (not Docker)
version: 1.0

# Build phase - install dependencies
build:
  commands:
    build:
      - pip install -r requirements.txt
    pre-build:
      - echo "Pre-build phase - setting up Python environment"
    post-build:
      - echo "Build completed successfully"

# Runtime configuration for Python
run:
  # Python runtime version
  runtime-version: python3.11

  # Command to start your FastAPI application
  command: python -m uvicorn main:app --host 0.0.0.0 --port 8000

  # Environment variables
  env:
    - name: PORT
      value: "8000"
    - name: ENVIRONMENT
      value: "production"
    - name: PYTHONUNBUFFERED
      value: "1"
    - name: PYTHONDONTWRITEBYTECODE
      value: "1"

  # Network configuration
  network:
    port: 8000
    env: PORT
